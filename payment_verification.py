import requestsimport osimport json# קובץ לשמירת משתמשים ששילמו (נוצר אוטומטית)PAID_USERS_FILE = 'paid_users.json'PAYPAL_API_URL = "https://api-m.sandbox.paypal.com"  # יש לשנות ל-Live כשתרצה לעלות לאוויר באמתCLIENT_ID = os.getenv('PAYPAL_CLIENT_ID')CLIENT_SECRET = os.getenv('PAYPAL_CLIENT_SECRET')def load_paid_users():    """טוען את רשימת המשתמשים ששילמו מקובץ"""    if not os.path.exists(PAID_USERS_FILE):        return []    with open(PAID_USERS_FILE, 'r') as f:        try:            return json.load(f)        except json.JSONDecodeError:            return []def save_paid_user(user_id):    """שומר משתמש חדש ברשימת המשלמים"""    users = load_paid_users()    if user_id not in users:        users.append(user_id)        with open(PAID_USERS_FILE, 'w') as f:            json.dump(users, f)def is_user_paid(user_id):    """בודק אם המשתמש קיים ברשימה"""    users = load_paid_users()    return user_id in usersdef mark_user_as_paid(user_id):    """פונקציה פומבית לסימון משתמש כמשולם"""    save_paid_user(user_id)# --- פונקציות עזר לפייפאל (לשימוש עתידי עם Webhook) ---def get_paypal_access_token():    if not CLIENT_ID or not CLIENT_SECRET:        return None            url = f"{PAYPAL_API_URL}/v1/oauth2/token"    headers = {"Accept": "application/json", "Accept-Language": "en_US"}    data = {"grant_type": "client_credentials"}        try:        response = requests.post(url, headers=headers, data=data, auth=(CLIENT_ID, CLIENT_SECRET))        if response.status_code == 200:            return response.json()['access_token']    except Exception as e:        print(f"PayPal Error: {e}")    return None